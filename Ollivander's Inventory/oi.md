![изображение](https://github.com/papchukev/SQL_solutions/assets/149643273/3c7a75b8-071c-4016-86a3-76f8c8394234)

------------------
    SELECT WANDS.ID, WANDS_PROPERTY.AGE, WANDS.COINS_NEEDED, WANDS.POWER
    FROM WANDS
    JOIN WANDS_PROPERTY ON WANDS_PROPERTY.CODE = WANDS.CODE
    WHERE WANDS_PROPERTY.IS_EVIL = 0 
    AND WANDS.COINS_NEEDED = (SELECT MIN(WA.COINS_NEEDED) 
                              FROM WANDS WA
                              JOIN WANDS_PROPERTY WP ON WP.CODE = WA.CODE
                              WHERE WA.POWER = WANDS.POWER AND WP.AGE = WANDS_PROPERTY.AGE)
    ORDER BY WANDS.POWER DESC, WANDS_PROPERTY.AGE DESC
